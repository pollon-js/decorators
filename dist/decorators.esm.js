/* @pollon/decorators - v1.0.0
* https://github.com/pollon-js/decorators#readme
* 2020 Francesco Lasaracina. Licensed ISC */
import{Application as t}from"@pollon/pollon";import{PropertyNeeder as e}from"@pollon/message-broker";function r(t,e,r,n,o,c,i){try{var a=t[c](i),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,o)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=a(t);if(e){var o=a(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function p(t,e,r){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}var s=function(t,e,r,n){if(r||n)throw"[Pollon decorators: ".concat(t," decorator can only be applied to a class")},y=function(t){return t[0].toUpperCase()+t.slice(1)};function h(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{property:null},u=o.property;return function(o,l,h){if(s("Service",0,l,h),!(r instanceof e))throw"[Pollon decorators: Service decorator InvalidArgumentException. `service` class must be of type PropertyNeeder]";if(!u&&!r.name)throw"[Pollon decorators: Service decorator in a class wide scope should be a class or you should specify a name parameter";return r.name&&(u=y(r.name)),function(e){i(l,e);var o=f(l);function l(){n(this,l);for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return o.call.apply(o,[this].concat(e))}return c(l,[{key:"init",value:function(){var e,n=new r(this.Module.appName),o=t.get(this.Module.appName);o.Providers.add(n),this[u]=n;for(var c=arguments.length,i=new Array(c),f=0;f<c;f++)i[f]=arguments[f];(e=p(a(l.prototype),"init",this)).call.apply(e,[this].concat(i))}}]),l}(o)}}function v(e){return function(o,u,l){if(s(o,0,l),!e)throw"[Pollon decorators: Juice decorator need the path to be set properly";return function(o){i(y,o);var u,l,s=f(y);function y(){n(this,y);for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return s.call.apply(s,[this].concat(e))}return c(y,[{key:"onApplyBindings",value:(u=regeneratorRuntime.mark((function r(){var n,o,c,i,u,l=arguments;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=t.get(this.Module.appName),r.next=3,o.Templates.Juice.get(e);case 3:for(c=l.length,i=new Array(c),u=0;u<c;u++)i[u]=l[u];return r.abrupt("return",(n=p(a(y.prototype),"onApplyBindings",this)).call.apply(n,[this].concat(i)));case 5:case"end":return r.stop()}}),r,this)})),l=function(){var t=this,e=arguments;return new Promise((function(n,o){var c=u.apply(t,e);function i(t){r(c,n,o,i,a,"next",t)}function a(t){r(c,n,o,i,a,"throw",t)}i(void 0)}))},function(){return l.apply(this,arguments)})}]),y}(o)}}export{v as Juice,h as Service};
